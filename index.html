<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feasibility Study: Mumbai-Pune Rapid Rail Link</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Custom Styles for Route Diagram */
        .station-node {
            width: 120px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            font-size: 0.875rem;
            position: relative;
            z-index: 10;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .station-node:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .route-line {
            position: absolute;
            background-color: #cbd5e1;
            z-index: 1;
            transition: background-color 0.5s ease;
        }
        .route-active .route-line {
            background-color: #3b82f6; /* Blue-500 */
        }
        .route-active .station-node {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        
        /* Chart Container overrides for specific constraints */
        .chart-wrapper {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 300px;
            margin: 0 auto;
        }
        
        @media (min-width: 768px) {
            .chart-wrapper {
                height: 350px;
            }
        }

        .tab-btn.active {
            border-bottom: 2px solid #ea580c; /* Orange-600 */
            color: #ea580c;
            font-weight: 600;
        }

        body {
            background-color: #f8fafc; /* Slate-50 */
            color: #334155; /* Slate-700 */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
    <!-- Chosen Palette: Warm Professional - Slate (Backgrounds/Text), Orange (Accents/Highlights), Blue (Data/Routes) -->
    <!-- Application Structure Plan: 
         1. Hero Section: Title & Executive Summary stats.
         2. Tabbed Navigation: 
            - Tab 1: Current Ecosystem (Analysis of existing trains, chart of travel times).
            - Tab 2: Route Comparison (Interactive Node Map of Kalyan vs Panvel, Pro/Con cards).
            - Tab 3: Feasibility Simulator (Sliders for speed/dwell time to calculate theoretical travel time).
            - Tab 4: Proposed Schedule (Visual timeline of the hourly alternating service).
         3. Why this structure? It moves the user from understanding the problem (current state) to analyzing options (routes) to testing the solution (simulator) and finally visualizing the outcome (schedule). 
    -->
    <!-- Visualization & Content Choices:
         - Bar Chart: Comparing Travel Times of current fleet. Goal: Highlight the need for speed.
         - Node Map (HTML/CSS): Visualizing the bifurcation at Kalyan vs Panvel. Goal: Spatial understanding without complex maps.
         - Donut Chart: Catchment Population. Goal: Show ridership potential of each route.
         - Interactive Timeline: Proposed Schedule. Goal: Visualize the frequency.
         - Interactive Calculator: Live math for travel time based on average speed.
         - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-orange-600 text-white p-2 rounded-lg">
                    <i class="fas fa-train-subway text-xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-slate-800 leading-tight">MUM-PUNE Rapid Rail Link</h1>
                    <p class="text-xs text-slate-500 font-medium">Feasibility Study & Service Proposal</p>
                </div>
            </div>
            <div class="hidden md:flex gap-6 text-sm text-slate-600">
                <div class="flex items-center gap-2">
                    <i class="fas fa-route text-orange-500"></i> 
                    <span>192 km Route Analysis</span>
                </div>
                <div class="flex items-center gap-2">
                    <i class="fas fa-clock text-orange-500"></i>
                    <span>Hourly Frequency Goal</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

        <!-- Executive Summary Cards -->
        <section class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-l-blue-500">
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Current Trains</p>
                <div class="flex items-end gap-2 mt-1">
                    <span class="text-3xl font-bold text-slate-800">12</span>
                    <span class="text-sm text-slate-500 mb-1">Daily Direct</span>
                </div>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-l-orange-500">
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Target Travel Time</p>
                <div class="flex items-end gap-2 mt-1">
                    <span class="text-3xl font-bold text-slate-800">2h 30m</span>
                    <span class="text-sm text-green-600 mb-1 font-semibold"><i class="fas fa-arrow-down"></i> 25%</span>
                </div>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-l-indigo-500">
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Proposed Fleet</p>
                <div class="flex items-end gap-2 mt-1">
                    <span class="text-3xl font-bold text-slate-800">Mini VB</span>
                    <span class="text-sm text-slate-500 mb-1">8 Coach</span>
                </div>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-l-emerald-500">
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Service Mode</p>
                <div class="flex items-end gap-2 mt-1">
                    <span class="text-3xl font-bold text-slate-800">Hourly</span>
                    <span class="text-sm text-slate-500 mb-1">Alternating</span>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <div class="flex border-b border-slate-200 mb-8 overflow-x-auto">
            <button onclick="switchTab('current-ecosystem')" id="tab-current-ecosystem" class="tab-btn active px-6 py-3 text-sm font-medium text-slate-600 hover:text-orange-600 transition-colors whitespace-nowrap">
                Existing Ecosystem
            </button>
            <button onclick="switchTab('route-analysis')" id="tab-route-analysis" class="tab-btn px-6 py-3 text-sm font-medium text-slate-600 hover:text-orange-600 transition-colors whitespace-nowrap">
                Route Analysis (Kalyan vs Panvel)
            </button>
            <button onclick="switchTab('feasibility-sim')" id="tab-feasibility-sim" class="tab-btn px-6 py-3 text-sm font-medium text-slate-600 hover:text-orange-600 transition-colors whitespace-nowrap">
                Feasibility Simulator
            </button>
            <button onclick="switchTab('proposed-schedule')" id="tab-proposed-schedule" class="tab-btn px-6 py-3 text-sm font-medium text-slate-600 hover:text-orange-600 transition-colors whitespace-nowrap">
                Future Schedule Model
            </button>
        </div>

        <!-- TAB 1: Current Ecosystem -->
        <div id="current-ecosystem" class="tab-content block animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Text Content -->
                <div class="lg:col-span-1 space-y-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-2">The Current Landscape</h2>
                        <p class="text-slate-600 leading-relaxed text-sm">
                            The Mumbai-Pune corridor is one of India's busiest, yet the rail service relies heavily on legacy express trains. 
                            While the Deccan Queen is legendary, average speeds remain low due to the challenging <strong>Bhor Ghat</strong> section 
                            and congestion in the Mumbai suburban network.
                        </p>
                    </div>
                    
                    <div class="bg-white p-5 rounded-lg border border-slate-200">
                        <h3 class="font-semibold text-slate-800 mb-3 flex items-center gap-2">
                            <i class="fas fa-triangle-exclamation text-yellow-500"></i> Pain Points
                        </h3>
                        <ul class="space-y-3 text-sm text-slate-600">
                            <li class="flex items-start gap-2">
                                <i class="fas fa-clock mt-1 text-slate-400"></i>
                                <span><strong>High Travel Time:</strong> Average 3h 25m for < 200km.</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-users mt-1 text-slate-400"></i>
                                <span><strong>Overcrowding:</strong> 110%+ occupancy on peak trains.</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-calendar-times mt-1 text-slate-400"></i>
                                <span><strong>Irregular Frequency:</strong> Gaps of 2-3 hours in afternoon.</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4">Travel Time Comparison (Current vs Target)</h3>
                    <div class="chart-wrapper">
                        <canvas id="currentTrainsChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-slate-400 mt-2">Data based on average scheduled duration for CSTM-Pune direction.</p>
                </div>
            </div>
        </div>

        <!-- TAB 2: Route Analysis -->
        <div id="route-analysis" class="tab-content hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-slate-800">Route Comparison: Via Kalyan vs. Via Panvel</h2>
                <p class="text-slate-600 mt-2">
                    To achieve an hourly service, utilizing alternative paths is crucial. The study proposes alternating routes to maximize catchment.
                </p>
            </div>

            <!-- Interactive Route Map -->
            <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 mb-8 relative overflow-hidden">
                <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-8 text-center">Interactive Corridor Map</h3>
                
                <!-- Map Container -->
                <div class="relative h-[300px] w-full max-w-4xl mx-auto select-none">
                    
                    <!-- Lines (SVG would be easier, but using CSS as requested) -->
                    <!-- Top Line (Kalyan) -->
                    <div class="absolute top-[80px] left-[100px] w-[250px] h-[2px] bg-blue-300 transform -rotate-12 origin-left"></div>
                    <div class="absolute top-[28px] left-[340px] w-[200px] h-[2px] bg-blue-300 transform rotate-12 origin-left"></div>

                    <!-- Bottom Line (Panvel) -->
                    <div class="absolute top-[100px] left-[100px] w-[250px] h-[2px] bg-orange-300 transform rotate-12 origin-left"></div>
                    <div class="absolute top-[152px] left-[340px] w-[200px] h-[2px] bg-orange-300 transform -rotate-12 origin-left"></div>

                    <!-- Common End Line -->
                    <div class="absolute top-[90px] left-[530px] w-[150px] h-[2px] bg-slate-400"></div>

                    <!-- Nodes -->
                    <!-- Mumbai -->
                    <div class="absolute top-[70px] left-0 station-node bg-slate-800 text-white border-2 border-slate-800 z-20"
                         onclick="highlightRoute('both')">
                        <i class="fas fa-city mb-1 block"></i> MUMBAI (CSMT)
                    </div>

                    <!-- Kalyan -->
                    <div id="node-kalyan" class="absolute top-0 left-[280px] station-node bg-white border-2 border-blue-400 text-blue-900 z-20"
                         onclick="highlightRoute('kalyan')">
                        <i class="fas fa-users mb-1 block"></i> KALYAN
                    </div>

                    <!-- Panvel -->
                    <div id="node-panvel" class="absolute top-[140px] left-[280px] station-node bg-white border-2 border-orange-400 text-orange-900 z-20"
                         onclick="highlightRoute('panvel')">
                        <i class="fas fa-plane-departure mb-1 block"></i> PANVEL
                    </div>

                    <!-- Lonavala -->
                    <div class="absolute top-[70px] left-[500px] station-node bg-white border-2 border-slate-400 text-slate-700 z-20"
                         onclick="highlightRoute('both')">
                        <i class="fas fa-mountain mb-1 block"></i> LONAVALA
                    </div>

                    <!-- Pune -->
                    <div class="absolute top-[70px] right-0 station-node bg-slate-800 text-white border-2 border-slate-800 z-20"
                         onclick="highlightRoute('both')">
                        <i class="fas fa-building mb-1 block"></i> PUNE
                    </div>

                </div>
                <p class="text-center text-xs text-slate-400 italic mt-4">Click on KALYAN or PANVEL nodes to see analysis.</p>
            </div>

            <!-- Route Details Cards (Dynamic) -->
            <div id="route-details-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Kalyan Details -->
                <div id="card-kalyan" class="bg-blue-50 p-6 rounded-lg border border-blue-100 transition-opacity duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-bold text-blue-900">Via Kalyan Route</h3>
                        <span class="bg-blue-200 text-blue-800 text-xs px-2 py-1 rounded">Traditional</span>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <p class="text-xs text-blue-600 font-semibold uppercase">Pros</p>
                            <p class="text-sm text-slate-700">Massive catchment area (Thane/Kalyan/Dombivli). High current demand.</p>
                        </div>
                        <div>
                            <p class="text-xs text-red-500 font-semibold uppercase">Cons</p>
                            <p class="text-sm text-slate-700">Severely congested tracks. Longer distance (192km). Frequent signal delays.</p>
                        </div>
                        <div class="pt-4 border-t border-blue-200">
                            <div class="flex justify-between text-sm">
                                <span>Est. Distance:</span>
                                <span class="font-bold">192 km</span>
                            </div>
                            <div class="flex justify-between text-sm mt-1">
                                <span>Population Served:</span>
                                <span class="font-bold">~4.5 Million</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Panvel Details -->
                <div id="card-panvel" class="bg-orange-50 p-6 rounded-lg border border-orange-100 transition-opacity duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-bold text-orange-900">Via Panvel Route</h3>
                        <span class="bg-orange-200 text-orange-800 text-xs px-2 py-1 rounded">Emerging</span>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <p class="text-xs text-green-600 font-semibold uppercase">Pros</p>
                            <p class="text-sm text-slate-700">Shorter route. Connects to upcoming Navi Mumbai Airport. Less local train interference.</p>
                        </div>
                        <div>
                            <p class="text-xs text-orange-600 font-semibold uppercase">Cons</p>
                            <p class="text-sm text-slate-700">Lower current density. Requires reversal or bypass at Karjat (Technical challenge).</p>
                        </div>
                        <div class="pt-4 border-t border-orange-200">
                            <div class="flex justify-between text-sm">
                                <span>Est. Distance:</span>
                                <span class="font-bold">177 km</span>
                            </div>
                            <div class="flex justify-between text-sm mt-1">
                                <span>Population Served:</span>
                                <span class="font-bold">~1.8 Million</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Catchment Chart -->
            <div class="mt-6 bg-white p-6 rounded-xl border border-slate-100">
                <h4 class="text-center font-semibold text-slate-700 mb-4">Passenger Catchment Potential Share</h4>
                <div class="chart-wrapper h-64">
                    <canvas id="catchmentChart"></canvas>
                </div>
            </div>
        </div>

        <!-- TAB 3: Feasibility Simulator -->
        <div id="feasibility-sim" class="tab-content hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Controls -->
                <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg border-t-4 border-indigo-500">
                    <h2 class="text-xl font-bold text-slate-800 mb-6">Service Simulator</h2>
                    
                    <div class="space-y-6">
                        <!-- Train Type Selection -->
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-2">Rolling Stock</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="setTrainType('namo')" id="btn-namo" class="py-2 px-3 border rounded-md text-sm font-medium transition-colors bg-indigo-600 text-white border-indigo-600">
                                    Namo Bharat Rapid Rail
                                </button>
                                <button onclick="setTrainType('vande')" id="btn-vande" class="py-2 px-3 border border-slate-300 rounded-md text-sm font-medium text-slate-600 hover:bg-slate-50 transition-colors">
                                    Mini Vande Bharat
                                </button>
                            </div>
                            <p id="train-desc" class="text-xs text-slate-500 mt-2">High acceleration, designed for inter-city rapid transit.</p>
                        </div>

                        <!-- Speed Slider -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium text-slate-700">Average Operating Speed</label>
                                <span id="speed-val" class="text-sm font-bold text-indigo-600">90 km/h</span>
                            </div>
                            <input type="range" min="60" max="130" value="90" id="speed-slider" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                            <div class="flex justify-between text-xs text-slate-400 mt-1">
                                <span>60 (Current)</span>
                                <span>130 (Max Potential)</span>
                            </div>
                        </div>

                        <!-- Route Toggle -->
                        <div class="flex items-center justify-between bg-slate-50 p-3 rounded-lg">
                            <span class="text-sm font-medium text-slate-700">Route Logic</span>
                            <select id="sim-route-select" class="text-sm border-none bg-transparent font-bold text-indigo-600 focus:ring-0 cursor-pointer">
                                <option value="kalyan">Via Kalyan (192km)</option>
                                <option value="panvel">Via Panvel (177km)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Results Display -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Key Outcome Metrics -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-indigo-50 p-5 rounded-xl border border-indigo-100 text-center">
                            <p class="text-xs font-bold text-indigo-400 uppercase">Estimated Travel Time</p>
                            <div id="result-time" class="text-4xl font-bold text-indigo-900 mt-2">2h 08m</div>
                            <p class="text-xs text-indigo-600 mt-1">Non-stop duration</p>
                        </div>
                        <div class="bg-emerald-50 p-5 rounded-xl border border-emerald-100 text-center">
                            <p class="text-xs font-bold text-emerald-400 uppercase">Daily Trips (Single Train)</p>
                            <div id="result-trips" class="text-4xl font-bold text-emerald-900 mt-2">3.5</div>
                            <p class="text-xs text-emerald-600 mt-1">Round trips possible</p>
                        </div>
                    </div>

                    <!-- Sensitivity Graph -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 h-64 chart-wrapper">
                        <canvas id="simulationChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 4: Proposed Schedule -->
        <div id="proposed-schedule" class="tab-content hidden animate-fade-in">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">Proposed Alternating Hourly Service</h2>
                <p class="text-slate-600 mb-8 max-w-3xl">
                    To satisfy the demand of both Central (Kalyan) and Harbour/Trans-Harbour (Panvel) passengers, the optimal strategy is an alternating hourly departure from CSMT.
                </p>

                <!-- Visual Schedule -->
                <div class="relative pl-8 border-l-2 border-slate-200 space-y-8">
                    
                    <!-- 06:00 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] top-0 bg-blue-500 text-white w-20 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-sm">
                            06:00
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 ml-4">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-blue-900">Depart CSMT <span class="text-slate-500 font-normal mx-2">via</span> KALYAN</h4>
                                <span class="text-xs bg-white px-2 py-1 rounded text-slate-500 border">Mini Vande Bharat</span>
                            </div>
                            <p class="text-sm text-slate-600 mt-1">Stops: Dadar, Thane, Kalyan, Lonavala, Shivajinagar.</p>
                        </div>
                    </div>

                    <!-- 07:00 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] top-0 bg-orange-500 text-white w-20 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-sm">
                            07:00
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border-l-4 border-orange-500 ml-4">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-orange-900">Depart CSMT <span class="text-slate-500 font-normal mx-2">via</span> PANVEL</h4>
                                <span class="text-xs bg-white px-2 py-1 rounded text-slate-500 border">Namo Bharat Rapid Rail</span>
                            </div>
                            <p class="text-sm text-slate-600 mt-1">Stops: Vadala, Panvel, Lonavala, Shivajinagar.</p>
                        </div>
                    </div>

                    <!-- 08:00 -->
                    <div class="relative">
                        <div class="absolute -left-[41px] top-0 bg-blue-500 text-white w-20 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-sm">
                            08:00
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 ml-4">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-blue-900">Depart CSMT <span class="text-slate-500 font-normal mx-2">via</span> KALYAN</h4>
                                <span class="text-xs bg-white px-2 py-1 rounded text-slate-500 border">Mini Vande Bharat</span>
                            </div>
                        </div>
                    </div>

                     <!-- 09:00 -->
                     <div class="relative">
                        <div class="absolute -left-[41px] top-0 bg-orange-500 text-white w-20 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-sm">
                            09:00
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border-l-4 border-orange-500 ml-4">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-orange-900">Depart CSMT <span class="text-slate-500 font-normal mx-2">via</span> PANVEL</h4>
                                <span class="text-xs bg-white px-2 py-1 rounded text-slate-500 border">Namo Bharat Rapid Rail</span>
                            </div>
                        </div>
                    </div>

                </div>
                
                <div class="mt-8 p-4 bg-slate-50 rounded text-center text-sm text-slate-500 italic">
                    * Pattern repeats throughout the day until 22:00.
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 py-6 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-500 text-sm">Feasibility Study.</p>
        </div>
    </footer>

    <script>
        // --- State Management ---
        const state = {
            currentTab: 'current-ecosystem',
            simSpeed: 90,
            simTrainType: 'namo', // 'namo' or 'vande'
            simRoute: 'kalyan', // 'kalyan' or 'panvel'
            distances: {
                kalyan: 192,
                panvel: 177
            }
        };

        // --- Chart Instances ---
        let currentTrainsChartInstance = null;
        let simulationChartInstance = null;
        let catchmentChartInstance = null;

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initCurrentTrainsChart();
            initCatchmentChart();
            initSimulationChart();
            updateSimulation();
            
            // Add listeners for Simulation controls
            document.getElementById('speed-slider').addEventListener('input', (e) => {
                state.simSpeed = parseInt(e.target.value);
                document.getElementById('speed-val').innerText = `${state.simSpeed} km/h`;
                updateSimulation();
            });

            document.getElementById('sim-route-select').addEventListener('change', (e) => {
                state.simRoute = e.target.value;
                updateSimulation();
            });
        });

        // --- Navigation Logic ---
        function switchTab(tabId) {
            // Update State
            state.currentTab = tabId;

            // UI Updates
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');

            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'text-orange-600', 'border-orange-600');
                btn.classList.add('text-slate-600');
            });
            const activeBtn = document.getElementById(`tab-${tabId}`);
            activeBtn.classList.add('active');

            // Resize charts if needed when tab becomes visible
            if(tabId === 'current-ecosystem' && currentTrainsChartInstance) currentTrainsChartInstance.resize();
            if(tabId === 'feasibility-sim' && simulationChartInstance) simulationChartInstance.resize();
            if(tabId === 'route-analysis' && catchmentChartInstance) catchmentChartInstance.resize();
        }

        // --- Interactive Map Logic ---
        function highlightRoute(route) {
            const kalyanNode = document.getElementById('node-kalyan');
            const panvelNode = document.getElementById('node-panvel');
            const kalyanCard = document.getElementById('card-kalyan');
            const panvelCard = document.getElementById('card-panvel');

            // Reset styles
            kalyanNode.style.opacity = '1';
            panvelNode.style.opacity = '1';
            kalyanCard.classList.remove('opacity-50');
            panvelCard.classList.remove('opacity-50');

            if (route === 'kalyan') {
                panvelNode.style.opacity = '0.4';
                panvelCard.classList.add('opacity-50');
            } else if (route === 'panvel') {
                kalyanNode.style.opacity = '0.4';
                kalyanCard.classList.add('opacity-50');
            }
        }

        // --- Simulation Logic ---
        function setTrainType(type) {
            state.simTrainType = type;
            
            // Update UI buttons
            const btnNamo = document.getElementById('btn-namo');
            const btnVande = document.getElementById('btn-vande');
            const desc = document.getElementById('train-desc');

            if (type === 'namo') {
                btnNamo.classList.add('bg-indigo-600', 'text-white', 'border-indigo-600');
                btnNamo.classList.remove('bg-white', 'text-slate-600', 'border-slate-300');
                btnVande.classList.remove('bg-indigo-600', 'text-white', 'border-indigo-600');
                btnVande.classList.add('bg-white', 'text-slate-600', 'border-slate-300');
                desc.innerText = "Namo Bharat: High acceleration, optimized for rapid regional transit.";
            } else {
                btnVande.classList.add('bg-indigo-600', 'text-white', 'border-indigo-600');
                btnVande.classList.remove('bg-white', 'text-slate-600', 'border-slate-300');
                btnNamo.classList.remove('bg-indigo-600', 'text-white', 'border-indigo-600');
                btnNamo.classList.add('bg-white', 'text-slate-600', 'border-slate-300');
                desc.innerText = "Mini Vande Bharat: Premium intercity comfort, higher top speed potential.";
            }
            updateSimulation();
        }

        function updateSimulation() {
            const distance = state.distances[state.simRoute];
            const speed = state.simSpeed;
            
            // Basic physics calculation: Time = Distance / Speed
            // Add 'inefficiency factor' for stops and ghat section (approx 15% delay)
            const inefficiency = state.simTrainType === 'namo' ? 1.10 : 1.15; // Namo accelerates faster
            
            const decimalHours = (distance / speed) * inefficiency;
            const hours = Math.floor(decimalHours);
            const minutes = Math.round((decimalHours - hours) * 60);

            // Update Time Display
            document.getElementById('result-time').innerText = `${hours}h ${minutes < 10 ? '0'+minutes : minutes}m`;

            // Update Trips Calculation (Assuming 16 hour operation window)
            // Round trip time + turnaround (45 mins)
            const roundTripTime = (decimalHours * 2) + 0.75; 
            const trips = (16 / roundTripTime).toFixed(1);
            document.getElementById('result-trips').innerText = trips;

            updateSimulationChart(distance);
        }

        // --- Chart.js Implementations ---

        function initCurrentTrainsChart() {
            const ctx = document.getElementById('currentTrainsChart').getContext('2d');
            currentTrainsChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Deccan Queen', 'Sinhagad Exp', 'Intercity Exp', 'Pragati Exp', 'Indrayani Exp'],
                    datasets: [{
                        label: 'Average Travel Time (Minutes)',
                        data: [195, 205, 190, 215, 200],
                        backgroundColor: '#cbd5e1',
                        borderRadius: 4,
                        borderSkipped: false
                    },
                    {
                        label: 'Proposed Rapid Rail',
                        data: [150, 150, 150, 150, 150], // Benchmark line
                        type: 'line',
                        borderColor: '#ea580c',
                        borderWidth: 2,
                        pointRadius: 0,
                        borderDash: [5, 5]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if(context.dataset.type === 'line') return 'Target: 2h 30m';
                                    const hours = Math.floor(context.raw / 60);
                                    const mins = context.raw % 60;
                                    return `${context.dataset.label}: ${hours}h ${mins}m`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 100,
                            title: { display: true, text: 'Minutes' }
                        }
                    }
                }
            });
        }

        function initCatchmentChart() {
            const ctx = document.getElementById('catchmentChart').getContext('2d');
            catchmentChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Via Kalyan Catchment', 'Via Panvel Catchment'],
                    datasets: [{
                        data: [70, 30],
                        backgroundColor: ['#3b82f6', '#f97316'], // Blue-500, Orange-500
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'right' }
                    }
                }
            });
        }

        function initSimulationChart() {
            const ctx = document.getElementById('simulationChart').getContext('2d');
            // Initial data structure
            const speeds = [60, 70, 80, 90, 100, 110, 120, 130];
            
            simulationChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: speeds,
                    datasets: [{
                        label: 'Travel Time (Minutes)',
                        data: [], // Populated dynamically
                        borderColor: '#4f46e5', // Indigo-600
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                title: (items) => `Speed: ${items[0].label} km/h`,
                                label: (item) => {
                                    const val = Math.round(item.raw);
                                    const h = Math.floor(val/60);
                                    const m = val%60;
                                    return `Time: ${h}h ${m}m`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Avg Speed (km/h)' } },
                        y: { title: { display: true, text: 'Travel Time (min)' } }
                    }
                }
            });
        }

        function updateSimulationChart(distance) {
            if (!simulationChartInstance) return;
            
            const speeds = [60, 70, 80, 90, 100, 110, 120, 130];
            const inefficiency = state.simTrainType === 'namo' ? 1.10 : 1.15;
            
            const times = speeds.map(s => {
                return ((distance / s) * inefficiency) * 60; // in minutes
            });

            simulationChartInstance.data.datasets[0].data = times;
            simulationChartInstance.update();
        }

    </script>
</body>
</html>